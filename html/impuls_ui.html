<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="img/logo.svg">
    <title>IMPULS-AINA - Sistema de Cerca Sem√†ntica</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fragment+Mono:ital@0;1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/impuls_styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-row">
                <img src="img/logo.svg" class="app-logo" alt="IMPULS logo">
            
                <div>
                    <h1 class="title-racing">impuls</h1>
                    
                </div>
            </div>

            <h2 class="subtitle-racing">Sistema de cerca sem√†ntica multilingue per a documents de recerca i innovaci√≥ amb tecnologia AINA</h2>
        
            <p class="subtitle">
                Cerca sem√†ntica multiling√ºe sobre<span id="status-badge" class="status-badge offline">Offline</span>  projectes R+I d'actors catalans (finan√ßats per Gencat, AEI, CDTI i Comissi√≥ Europea).  
                Ent√©n consultes naturals, aplica filtres autom√†tics, expandeix conceptes  
                i visualitza relacions amb un graf de coneixement interactiu. Projecte AINA Challenge 2025.</br>
            </p>
        </header>
        <div class="search-section">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('search')">Cerca Sem√†ntica</button>
                <button class="tab" onclick="switchTab('graph')">Graf de Coneixement</button>
                <button class="tab" onclick="switchTab('stats')">Informaci√≥ del Sistema</button>
            </div>

            <!-- Search Tab -->
            <div id="search-tab" class="tab-content active">
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="Cerca projectes... (ex: projectes d'IA en salut, energies renovables)">
                    <button onclick="performSearch()">Cercar</button>
                </div>
                <div class="options-section">
                    <div class="options-row">
                        <div class="checkbox-group active" onclick="toggleCheckbox('use-parsing')">
                            <input type="checkbox" id="use-parsing" checked>
                            <label>ü§ñ Parsing Intel¬∑ligent</label>
                        </div>
                        <div class="checkbox-group active" onclick="toggleCheckbox('use-expansion')">
                            <input type="checkbox" id="use-expansion" checked>
                            <label>üîó Expansi√≥ Sem√†ntica</label>
                        </div>
                        <div class="option-group">
                            <label>Resultats:</label>
                            <select id="top-k">
                                <option value="5">5</option>
                                <option value="10">10</option>
                                <option value="20">20</option>
                                <option value="50" selected>50</option>
                            </select>
                        </div>
                    </div>
                    <div id="expansion-controls" class="expansion-controls show">
                        <div class="expansion-section">
                            <div class="expansion-title"><span class="icon">üåê</span> Termes equivalents</div>
                            <div class="expansion-hint">Inclou el mateix concepte en altres idiomes i termes equivalents</div>
                            <div class="level-checkboxes">
                                <label class="level-checkbox checked" onclick="toggleLevel(this, 'alias', 1)"><input type="checkbox" checked> Molt similars</label>
                                <label class="level-checkbox checked" onclick="toggleLevel(this, 'alias', 2)"><input type="checkbox" checked> Termes propers</label>
                                <label class="level-checkbox" onclick="toggleLevel(this, 'alias', 3)"><input type="checkbox"> Altres termes relacionats</label>
                            </div>
                        </div>
                        <div class="expansion-section">
                            <div class="expansion-title"><span class="icon">üîº</span> Conceptes m√©s amplis</div>
                            <div class="expansion-hint">Inclou categories superiors per ampliar la cerca</div>
                            <div class="level-checkboxes">
                                <label class="level-checkbox parent-level" onclick="toggleLevel(this, 'parent', 1)"><input type="checkbox"> Directes</label>
                                <label class="level-checkbox parent-level" onclick="toggleLevel(this, 'parent', 2)"><input type="checkbox"> Relacionats</label>
                                <label class="level-checkbox parent-level" onclick="toggleLevel(this, 'parent', 3)"><input type="checkbox"> Generals</label>
                            </div>
                        </div>
                    </div>
                    <div class="filters-section">
                        <div class="filters-header" onclick="toggleFilters()">
                            <span>‚öôÔ∏è Filtres Avan√ßats</span>
                            <span id="filters-arrow">‚ñº</span>
                        </div>
                        <div id="filters-content" class="filters-content">
                            <div class="filters-grid">
                                <div class="filter-group"><label>Framework:</label><input type="text" id="filter-framework" placeholder="H2020, AEI..."></div>
                                <div class="filter-group"><label>Instrument:</label><input type="text" id="filter-instrument" placeholder="RIA, IA..."></div>
                                <div class="filter-group"><label>Any des de:</label><input type="number" id="filter-year-from" placeholder="2015" min="2000" max="2030"></div>
                                <div class="filter-group"><label>Any fins a:</label><input type="number" id="filter-year-to" placeholder="2024" min="2000" max="2030"></div>
                                <div class="filter-group"><label>Pa√≠s:</label><input type="text" id="filter-country" placeholder="Spain..."></div>
                                <div class="filter-group"><label>Regi√≥:</label><input type="text" id="filter-region" placeholder="Catalunya..."></div>
                                <div class="filter-group"><label>Prov√≠ncia:</label><input type="text" id="filter-province" placeholder="Barcelona..."></div>
                                <div class="filter-group"><label>Tipus Entitat:</label><input type="text" id="filter-org-type" placeholder="HES, EMPRESA..."></div>
                            </div>
                            <button class="clear-filters-btn" onclick="clearFilters()">üóëÔ∏è Netejar Filtres</button>
                        </div>
                    </div>
                </div>
                <div id="feedback-section" class="feedback-section"></div>
                <div id="results" class="results"></div>
                <div id="debug-section" class="debug-section" style="display: none;">
                    <div class="debug-header" onclick="toggleDebug()">
                        <span id="debug-icon" class="debug-icon">‚ñ∂</span>
                        <span>üîß Debug: API Request & Response</span>
                    </div>
                    <div id="debug-content" class="debug-content"></div>
                </div>
            </div>

            <!-- Graph Tab -->
            <div id="graph-tab" class="tab-content">
                <div class="graph-container">
                    <div class="graph-sidebar">
                        <div class="graph-search-box">
                            <input type="text" id="graph-search-input" placeholder="Cerca conceptes...">
                            <button onclick="searchKBConcepts()">Cercar</button>
                        </div>
                        <div class="graph-search-results" id="graph-search-results">
                            <div style="padding: 20px; color: #888; text-align: center;">Cerca un concepte per explorar el graf</div>
                        </div>
                    </div>
                    <div class="graph-canvas-container">
                        <svg id="graph-canvas"></svg>
                        <div class="graph-info-bar" id="graph-info-bar" style="display: none;">
                            Nodes: <span id="graph-node-count">0</span> ¬∑ Clic per opcions ¬∑ Doble-clic per expandir
                        </div>
                        <div class="graph-details-panel" id="graph-details-panel"></div>
                        <div class="graph-legend">
                            <div class="graph-legend-item"><span class="graph-legend-dot selected"></span> Seleccionat</div>
                            <div class="graph-legend-item"><span class="graph-legend-dot parent"></span> Concepte pare</div>
                            <div class="graph-legend-item"><span class="graph-legend-dot child"></span> Concepte fill</div>
                            <div class="graph-legend-item"><span class="graph-legend-dot external"></span> Fora del KB</div>
                        </div>
                    </div>
                </div>
                <div class="graph-context-menu" id="graph-context-menu">
                    <div class="graph-context-menu-item" onclick="contextMenuAction('search')"><span class="icon">üîç</span> Cercar projectes</div>
                    <div class="graph-context-menu-item" id="context-menu-expand" onclick="contextMenuAction('expand')"><span class="icon">üîº</span> Expandir</div>
                    <div class="graph-context-menu-item" onclick="contextMenuAction('center')"><span class="icon">üéØ</span> Centrar</div>
                    <div class="graph-context-menu-item" onclick="contextMenuAction('hide')"><span class="icon">‚ùå</span> Amagar</div>
                </div>
            </div>

            <!-- Stats Tab -->
            <div id="stats-tab" class="tab-content">
                <div id="stats-results"><div class="info-message">Carregant informaci√≥ del sistema...</div></div>
            </div>
        </div>
    </div>

    <!-- External JavaScript files -->
    <script src="js/impuls_config.js"></script>
    <script src="js/impuls_search.js"></script>
    <script src="js/impuls_graph.js"></script>
    <script src="js/impuls_init.js"></script>
</body>
</html>
